"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8965],{99644:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>l,toc:()=>h});var a=t(85893),r=t(11151),i=t(71183);const s={id:"marketplace",title:"Marketplace",sidebar_label:"Marketplace"},c=void 0,l={id:"tutorials/nfts/marketplace",title:"Marketplace",description:"Trong h\u01b0\u1edbng d\u1eabn n\xe0y, b\u1ea1n s\u1ebd t\xecm hi\u1ec3u nh\u1eefng \u0111i\u1ec1u c\u01a1 b\u1ea3n c\u1ee7a m\u1ed9t NFT marketplace contract, n\u01a1i b\u1ea1n c\xf3 th\u1ec3 mua v\xe0 b\xe1n c\xe1c non-fungible token b\u1eb1ng $NEAR. Trong nh\u1eefng h\u01b0\u1edbng d\u1eabn tr\u01b0\u1edbc, b\u1ea1n \u0111\xe3 \u0111i qua v\xe0 t\u1ea1o m\u1ed9t NFT contract ho\xe0n ch\u1ec9nh \u0111\u1ea7y \u0111\u1ee7 k\u1ebft h\u1ee3p t\u1ea5t c\u1ea3 c\xe1c ti\xeau chu\u1ea9n c\xf3 trong ti\xeau chu\u1ea9n NFT.",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/3.tutorials/nfts/8-marketplace.md",sourceDirName:"3.tutorials/nfts",slug:"/tutorials/nfts/marketplace",permalink:"/vi/tutorials/nfts/marketplace",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/nfts/8-marketplace.md",tags:[],version:"current",lastUpdatedBy:"Github Actions",lastUpdatedAt:1719825734e3,sidebarPosition:8,frontMatter:{id:"marketplace",title:"Marketplace",sidebar_label:"Marketplace"},sidebar:"tutorials",previous:{title:"Approval",permalink:"/vi/tutorials/nfts/approvals"},next:{title:"Royalty",permalink:"/vi/tutorials/nfts/royalty"}},o={},h=[{value:"Gi\u1edbi thi\u1ec7u",id:"gi\u1edbi-thi\u1ec7u",level:2},{value:"Hi\u1ec3u v\u1ec1 contract",id:"hi\u1ec3u-v\u1ec1-contract",level:2},{value:"lib.rs",id:"lib-rs",level:2},{value:"Initialization function",id:"initialization-function",level:3},{value:"Model qu\u1ea3n l\xfd storage",id:"storage-management-model",level:3},{value:"sale.rs",id:"sale",level:2},{value:"Logic ni\xeam y\u1ebft",id:"listing-logic",level:3},{value:"nft_approve",id:"nft_approve",level:4},{value:"list_nft_for_sale",id:"list_nft_for_sale",level:4},{value:"process_listing",id:"process_listing",level:4},{value:"Sale object",id:"sale-object",level:3},{value:"X\xf3a c\xe1c sale",id:"removing-sales",level:3},{value:"C\u1eadp nh\u1eadt gi\xe1",id:"updating-price",level:3},{value:"Mua c\xe1c NFT",id:"purchasing-nfts",level:3},{value:"sale_view.rs",id:"sale_view-rs",level:2},{value:"Deployment and Initialization",id:"deployment-and-initialization",level:2},{value:"Minting and approving",id:"minting-and-approving",level:3},{value:"Listing NFT on sale",id:"listing-nft-on-sale",level:3},{value:"T\u1ed5ng l\u01b0\u1ee3ng cung",id:"total-supply",level:3},{value:"T\u1ed5ng l\u01b0\u1ee3ng cung b\u1edfi ch\u1ee7 s\u1edf h\u1eefu",id:"total-supply-by-owner",level:3},{value:"T\u1ed5ng l\u01b0\u1ee3ng cung theo contract",id:"total-supply-by-contract",level:3},{value:"Truy v\u1ea5n th\xf4ng tin ni\xeam y\u1ebft",id:"query-listing-information",level:3},{value:"T\u1ed5ng k\u1ebft",id:"t\u1ed5ng-k\u1ebft",level:2}];function u(n){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(e.p,{children:["Trong h\u01b0\u1edbng d\u1eabn n\xe0y, b\u1ea1n s\u1ebd t\xecm hi\u1ec3u nh\u1eefng \u0111i\u1ec1u c\u01a1 b\u1ea3n c\u1ee7a m\u1ed9t NFT marketplace contract, n\u01a1i b\u1ea1n c\xf3 th\u1ec3 mua v\xe0 b\xe1n c\xe1c non-fungible token b\u1eb1ng $NEAR. Trong nh\u1eefng h\u01b0\u1edbng d\u1eabn tr\u01b0\u1edbc, b\u1ea1n \u0111\xe3 \u0111i qua v\xe0 t\u1ea1o m\u1ed9t NFT contract ho\xe0n ch\u1ec9nh \u0111\u1ea7y \u0111\u1ee7 k\u1ebft h\u1ee3p t\u1ea5t c\u1ea3 c\xe1c ti\xeau chu\u1ea9n c\xf3 trong ",(0,a.jsx)(e.a,{href:"https://nomicon.io/Standards/NonFungibleToken",children:"ti\xeau chu\u1ea9n NFT"}),"."]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"gi\u1edbi-thi\u1ec7u",children:"Gi\u1edbi thi\u1ec7u"}),"\n",(0,a.jsxs)(e.p,{children:["Throughout this tutorial, you'll learn how a marketplace contract ",(0,a.jsx)(e.strong,{children:"could"})," work on NEAR. This is meant to be ",(0,a.jsx)(e.strong,{children:"an example"})," as there is no ",(0,a.jsx)(e.strong,{children:"canonical implementation"}),". Vui l\xf2ng t\xe1ch branch v\xe0 s\u1eeda \u0111\u1ed5i contract n\xe0y \u0111\u1ec3 \u0111\xe1p \u1ee9ng nhu c\u1ea7u c\u1ee5 th\u1ec3 c\u1ee7a b\u1ea1n."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"cd market-contract/\n"})}),"\n",(0,a.jsx)(e.p,{children:"This folder contains both the actual contract code and dependencies as outlined below."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"market-contract\n\u251c\u2500\u2500 Cargo.lock\n\u251c\u2500\u2500 Cargo.toml\n\u251c\u2500\u2500 README.md\n\u2514\u2500\u2500 src\n    \u251c\u2500\u2500 external.rs\n    \u251c\u2500\u2500 internal.rs\n    \u251c\u2500\u2500 lib.rs\n    \u251c\u2500\u2500 nft_callbacks.rs\n    \u251c\u2500\u2500 sale.rs\n    \u2514\u2500\u2500 sale_views.rs\n"})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"hi\u1ec3u-v\u1ec1-contract",children:"Hi\u1ec3u v\u1ec1 contract"}),"\n",(0,a.jsx)(e.p,{children:"L\xfac \u0111\u1ea7u, contract c\xf3 th\u1ec3 kh\xe1 cho\xe1ng ng\u1ee3p nh\u01b0ng n\u1ebfu b\u1ea1n lo\u1ea1i b\u1ecf t\u1ea5t c\u1ea3 c\xe1c th\u1ee9 kh\xf4ng c\u1ea7n thi\u1ebft v\xe0 \u0111\xe0o s\xe2u v\xe0o c\xe1c function c\u1ed1t l\xf5i, n\xf3 th\u1ef1c s\u1ef1 kh\xe1 \u0111\u01a1n gi\u1ea3n. Contract n\xe0y \u0111\xe3 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf ch\u1ec9 cho m\u1ed9t \u0111i\u1ec1u duy nh\u1ea5t - cho ph\xe9p m\u1ecdi ng\u01b0\u1eddi mua v\xe0 b\xe1n c\xe1c NFT cho NEAR. N\xf3 bao g\u1ed3m vi\u1ec7c h\u1ed7 tr\u1ee3 thanh to\xe1n royalty, c\u1eadp nh\u1eadt gi\xe1 b\xe1n c\u1ee7a b\u1ea1n, lo\u1ea1i b\u1ecf sale v\xe0 thanh to\xe1n cho storage."}),"\n",(0,a.jsx)(e.p,{children:"H\xe3y xem qua c\xe1c file, ghi ch\xfa l\u1ea1i m\u1ed9t s\u1ed1 function quan tr\u1ecdng v\xe0 ch\u1ee9c n\u0103ng c\u1ee7a ch\xfang l\xe0 g\xec."}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"lib-rs",children:"lib.rs"}),"\n",(0,a.jsx)(e.p,{children:"File n\xe0y ph\xe1c th\u1ea3o th\xf4ng tin n\xe0o \u0111\u01b0\u1ee3c l\u01b0u tr\u1eef tr\xean contract c\u0169ng nh\u01b0 m\u1ed9t s\u1ed1 function quan tr\u1ecdng kh\xe1c m\xe0 b\u1ea1n s\u1ebd t\xecm hi\u1ec3u b\xean d\u01b0\u1edbi."}),"\n",(0,a.jsx)(e.h3,{id:"initialization-function",children:"Initialization function"}),"\n",(0,a.jsxs)(e.p,{children:["Function \u0111\u1ea7u ti\xean b\u1ea1n s\u1ebd xem l\xe0 initialization function. N\xf3 l\u1ea5y m\u1ed9t ",(0,a.jsx)(e.code,{children:"owner_id"})," l\xe0m tham s\u1ed1 duy nh\u1ea5t v\xe0 s\u1ebd m\u1eb7c \u0111\u1ecbnh t\u1ea5t c\u1ea3 c\xe1c storage collection b\u1eb1ng gi\xe1 tr\u1ecb m\u1eb7c \u0111\u1ecbnh c\u1ee7a ch\xfang."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"92",end:"107",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/lib.rs"}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"storage-management-model",children:"Model qu\u1ea3n l\xfd storage"}),"\n",(0,a.jsxs)(e.p,{children:["Next, let's talk about the storage management model chosen for this contract. On the NFT contract, users attached $NEAR to the calls that needed storage paid for. For example, if someone was minting an NFT, they would need to attach ",(0,a.jsx)(e.code,{children:"x"})," amount of NEAR to cover the cost of storing the data on the contract."]}),"\n",(0,a.jsx)(e.p,{children:"On this marketplace contract, however, the storage model is a bit different. Users will need to deposit $NEAR onto the marketplace to cover the storage costs. Whenever someone puts an NFT for sale, the marketplace needs to store that information which costs $NEAR. Users can either deposit as much NEAR as they want so that they never have to worry about storage again or they can deposit the minimum amount to cover 1 sale on an as-needed basis."}),"\n",(0,a.jsx)(e.p,{children:"You might be thinking about the scenario when a sale is purchased. What happens to the storage that is now being released on the contract? This is why we've introduced a storage withdrawal function. This allows users to withdraw any excess storage that is not being used. Let's go through some scenarios to understand the logic. The required storage for 1 sale is 0.01 NEAR on the marketplace contract."}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"Scenario A"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Benji mu\u1ed1n \u0111\u01b0a NFT l\xean marketplace nh\u01b0ng anh \u1ea5y ch\u01b0a bao gi\u1edd tr\u1ea3 ti\u1ec1n cho storage."}),"\n",(0,a.jsxs)(e.li,{children:["Anh \u1ea5y n\u1ea1p ch\xednh x\xe1c 0.01 NEAR s\u1eed d\u1ee5ng method ",(0,a.jsx)(e.code,{children:"storage_deposit"}),". N\xf3 s\u1ebd thanh to\xe1n cho 1 l\u1ea7n b\xe1n."]}),"\n",(0,a.jsxs)(e.li,{children:["Anh \u1ea5y \u0111\u01b0a NFT l\xean marketplace v\xe0 b\xe2y gi\u1edd \u0111ang s\u1eed d\u1ee5ng h\u1ebft 1 trong s\u1ed1 1 l\u1ea7n sale \u0111\xe3 \u0111\u01b0\u1ee3c thanh to\xe1n tr\u01b0\u1edbc v\xe0 kh\xf4ng c\xf2n storage. N\u1ebfu anh \u1ea5y call ",(0,a.jsx)(e.code,{children:"storage_withdraw"}),", s\u1ebd kh\xf4ng c\xf3 g\xec x\u1ea3y ra."]}),"\n",(0,a.jsx)(e.li,{children:"Dorian th\xedch NFT c\u1ee7a anh \u1ea5y v\xe0 nhanh ch\xf3ng mua n\xf3 tr\u01b0\u1edbc b\u1ea5t c\u1ee9 ai. \u0110i\u1ec1u n\xe0y c\xf3 ngh\u0129a r\u1eb1ng \u0111\u01a1n h\xe0ng c\u1ee7a Benji b\xe2y gi\u1edd \u0111\xe3 b\u1ecb g\u1ee1 xu\u1ed1ng (k\u1ec3 t\u1eeb khi n\xf3 \u0111\u01b0\u1ee3c mua) v\xe0 Benji \u0111\xe3 s\u1eed d\u1ee5ng 0 trong s\u1ed1 1 l\u1ea7n sale \u0111\xe3 thanh to\xe1n tr\u01b0\u1edbc. N\xf3i c\xe1ch kh\xe1c, anh \u1ea5y \u0111ang th\u1eeba 1 l\u1ea7n sale hay 0.01 NEAR."}),"\n",(0,a.jsxs)(e.li,{children:["Benji b\xe2y gi\u1edd c\xf3 th\u1ec3 call ",(0,a.jsx)(e.code,{children:"storage_withdraw"})," v\xe0 s\u1ebd \u0111\u01b0\u1ee3c chuy\u1ec3n l\u1ea1i 0.01 NEAR cho anh \u1ea5y. V\u1ec1 ph\xeda contract, sau khi r\xfat ti\u1ec1n, anh \u1ea5y s\u1ebd c\xf3 0 l\u1ea7n sale \u0111\u01b0\u1ee3c thanh to\xe1n s\u1ebd c\u1ea7n ph\u1ea3i n\u1ea1p ti\u1ec1n storage tr\u01b0\u1edbc khi ni\xeam y\u1ebft th\xeam NFT."]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"Scenario B"})}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Dorian s\u1edf h\u1eefu m\u1ed9t tr\u0103m NFT r\u1ea5t \u0111\u1eb9p v\xe0 anh ta mu\u1ed1n ni\xeam y\u1ebft to\xe0n b\u1ed9."}),"\n",(0,a.jsxs)(e.li,{children:["\u0110\u1ec3 tr\xe1nh ph\u1ea3i g\u1ecdi ",(0,a.jsx)(e.code,{children:"storage_deposit"})," m\u1ed7i khi mu\u1ed1n ni\xeam y\u1ebft m\u1ed9t NFT, anh \u1ea5y s\u1ebd g\u1ecdi n\xf3 m\u1ed9t l\u1ea7n. V\xec Dorian l\xe0 m\u1ed9t ng\u01b0\u1eddi c\xf3 ti\u1ec1n, anh \u0111\xe3 \u0111\xe3 \u0111\xednh k\xe8m 10 NEAR \u0111\u1ee7 \u0111\u1ec3 thanh to\xe1n cho 1000 l\u1ea7n sale. Then he lists his 100 NFTs and now he has an excess of 9 NEAR or 900 sales."]}),"\n",(0,a.jsxs)(e.li,{children:["Dorian c\u1ea7n 9 NEAR \u0111\u1ec3 \u0111\u1ec3 l\xe0m g\xec \u0111\xf3 nh\u01b0ng anh \u1ea5y kh\xf4ng mu\u1ed1n g\u1ee1 100 NFT \u0111ang ni\xeam y\u1ebft. B\u1edfi v\xec anh \u1ea5y c\xf3 th\u1eeba 9 NEAR, anh \u1ea5y c\xf3 th\u1ec3 d\u1ec5 d\xe0ng r\xfat v\xe0 v\u1eabn c\xf3 100 NFT \u0111ang ni\xeam y\u1ebft. Sau khi call ",(0,a.jsx)(e.code,{children:"storage_withdraw"})," v\xe0 \u0111\u01b0\u1ee3c chuy\u1ec3n 9 NEAR, anh \u1ea5y c\xf3 0 l\u1ea7n sale \u0111ang th\u1eeba."]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"With this behavior in mind, the following two functions outline the logic."}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"111",end:"139",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/lib.rs"}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"144",end:"175",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/lib.rs"}),"\n",(0,a.jsxs)(e.p,{children:["Trong contract n\xe0y, storage y\xeau c\u1ea7u 0.01 NEAR cho m\u1ed7i l\u1ea7n sale nh\u01b0ng b\u1ea1n c\xf3 th\u1ec3 truy v\u1ea5n th\xf4ng tin \u0111\xf3 s\u1eed d\u1ee5ng function ",(0,a.jsx)(e.code,{children:"storage_minimum_balance"}),". Ngo\xe0i ra, b\u1ea1n c\xf3 th\u1ec3 truy v\u1ea5n function ",(0,a.jsx)(e.code,{children:"storage_balance_of"})," \u0111\u1ec3 ki\u1ec3m tra m\u1ed9t t\xe0i kho\u1ea3n n\xe0o \u0111\xf3 \u0111\xe3 thanh to\xe1n bao nhi\xeau storage."]}),"\n",(0,a.jsxs)(e.p,{children:["With that out of the way, it's time to move onto the ",(0,a.jsx)(e.code,{children:"sale.rs"})," file where you'll look at how NFTs are put for sale."]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"sale",children:"sale.rs"}),"\n",(0,a.jsx)(e.p,{children:"This file is responsible for the internal marketplace logic."}),"\n",(0,a.jsx)(e.h3,{id:"listing-logic",children:"Logic ni\xeam y\u1ebft"}),"\n",(0,a.jsx)(e.p,{children:"In order to put an NFT on sale, a user should:"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:["Approve the marketplace contract on an NFT token (by calling ",(0,a.jsx)(e.code,{children:"nft_approve"})," method on the NFT contract)"]}),"\n",(0,a.jsxs)(e.li,{children:["Call the ",(0,a.jsx)(e.code,{children:"list_nft_for_sale"})," method on the marketplace contract."]}),"\n"]}),"\n",(0,a.jsx)(e.h4,{id:"nft_approve",children:"nft_approve"}),"\n",(0,a.jsxs)(e.p,{children:["This method has to be called by the user to ",(0,a.jsx)(e.a,{href:"/vi/tutorials/nfts/approvals",children:"approve our marketplace"}),", so it can transfer the NFT on behalf of the user. In our contract, we only need to implement the ",(0,a.jsx)(e.code,{children:"nft_on_approve"})," method, which is called by the NFT contract when the user approves our contract."]}),"\n",(0,a.jsx)(e.p,{children:"In our case, we left it blank, but you could implement it to do some additional logic when the user approves your contract."}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"23",end:"33",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/nft_callbacks.rs"}),"\n",(0,a.jsx)(e.h4,{id:"list_nft_for_sale",children:"list_nft_for_sale"}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"list_nft_for_sale"})," method lists an nft for sale, for this, it takes the id of the NFT contract (",(0,a.jsx)(e.code,{children:"nft_contract_id"}),"), the ",(0,a.jsx)(e.code,{children:"token_id"})," to know which token is listed, the ",(0,a.jsx)(e.a,{href:"/vi/tutorials/nfts/approvals",children:(0,a.jsx)(e.code,{children:"approval_id"})}),", and the price in yoctoNEAR at which we want to sell the NFT."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"33",end:"74",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsxs)(e.p,{children:["The function first checks if the user has ",(0,a.jsx)(e.a,{href:"#storage-management-model-storage-management-model",children:"enough storage available"}),", and makes two calls in parallel to the NFT contract. The first is to check if this marketplace contract is authorized to transfer the NFT. The second is to make sure that the caller (",(0,a.jsx)(e.code,{children:"predecessor"}),") is actually the owner of the NFT, otherwise, anyone could call this method to create fake listings. This second call is mostly a measure to avoid spam, since anyways, only the owner could approve the marketplace contract to transfer the NFT."]}),"\n",(0,a.jsxs)(e.p,{children:["Both calls return their results to the ",(0,a.jsx)(e.code,{children:"process_listing"})," function, which executes the logic to store the sale object on the contract."]}),"\n",(0,a.jsx)(e.h4,{id:"process_listing",children:"process_listing"}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"process_listing"})," function will receive if our marketplace is authorized to list the NFT on sale, and if this was requested by the NFTs owner. If both conditions are met, it will proceed to check if the user has enough storage, and store the sale object on the contract."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"264",end:"344",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsx)("hr",{class:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"sale-object",children:"Sale object"}),"\n",(0,a.jsx)(e.p,{children:"\u0110i\u1ec1u quan tr\u1ecdng l\xe0 ph\u1ea3i hi\u1ec3u contract \u0111ang l\u01b0u tr\u1eef th\xf4ng tin g\xec c\u1ee7a m\u1ed7i sale object. B\u1edfi v\xec marketplace c\xf3 nhi\u1ec1u NFT \u0111\u01b0\u1ee3c ni\xeam y\u1ebft \u0111\u1ebfn t\u1eeb c\xe1c NFT contract kh\xe1c nhau, ch\u1ec9 l\u01b0u tr\u1eef token ID s\u1ebd kh\xf4ng \u0111\u1ee7 \u0111\u1ec3 ph\xe2n bi\u1ec7t gi\u1eefa c\xe1c NFT kh\xe1c nhau. \u0110\xe2y l\xe0 l\xfd do b\u1ea1n c\u1ea7n theo d\xf5i c\u1ea3 token ID v\xe0 contract m\xe0 NFT \u0111\u1ebfn t\u1eeb \u0111\xf3. Ngo\xe0i ra, v\u1edbi m\u1ed7i ni\xeam y\u1ebft, contract ph\u1ea3i theo d\xf5i approval ID m\xe0 n\xf3 \u0111\xe3 \u0111\u01b0\u1ee3c c\u1ea5p \u0111\u1ec3 transfer NFT. Cu\u1ed1i c\xf9ng, ch\u1ee7 s\u1edf h\u1eefu v\xe0 c\xe1c \u0111i\u1ec1u ki\u1ec7n sale l\xe0 c\u1ea7n thi\u1ebft."}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"5",end:"20",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"removing-sales",children:"X\xf3a c\xe1c sale"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 x\xf3a m\u1ed9t ni\xeam y\u1ebft, ch\u1ee7 s\u1edf h\u1eefu ph\u1ea3i call function ",(0,a.jsx)(e.code,{children:"remove_sale"})," v\xe0 truy\u1ec1n v\xe0o NFT contract c\xf9ng v\u1edbi token ID. Ph\xeda \u0111\u1eb1ng sau, h\xe0m n\xe0y call function ",(0,a.jsx)(e.code,{children:"internal_remove_sale"})," m\xe0 b\u1ea1n c\xf3 th\u1ec3 t\xecm th\u1ea5y trong file ",(0,a.jsx)(e.code,{children:"internal.rs"}),". \u0110i\u1ec1u n\xe0y s\u1ebd y\xeau c\u1ea7u m\u1ed9t yoctoNEAR v\xec l\xfd do b\u1ea3o m\u1eadt."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"76",end:"87",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"updating-price",children:"C\u1eadp nh\u1eadt gi\xe1"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 c\u1eadp nh\u1eadt gi\xe1 ni\xeam y\u1ebft c\u1ee7a token, ch\u1ee7 s\u1edf h\u1eefu ph\u1ea3i call function ",(0,a.jsx)(e.code,{children:"update_price"})," v\xe0 truy\u1ec1n v\xe0o contract, token ID, v\xe0 gi\xe1 mong mu\u1ed1n. Vi\u1ec7c n\xe0y s\u1ebd l\u1ea5y sale object, thay \u0111\u1ed5i c\xe1c \u0111i\u1ec1u ki\u1ec7n sale v\xe0 ch\xe8n n\xf3 tr\u1edf l\u1ea1i. V\xec l\xfd do b\u1ea3o m\u1eadt, function n\xe0y s\u1ebd y\xeau c\u1ea7u m\u1ed9t yoctoNEAR."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"90",end:"118",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"purchasing-nfts",children:"Mua c\xe1c NFT"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 mua c\xe1c NFT, b\u1ea1n ph\u1ea3i call function ",(0,a.jsx)(e.code,{children:"offer"}),". N\xf3 nh\u1eadn ",(0,a.jsx)(e.code,{children:"nft_contract_id"})," v\xe0 ",(0,a.jsx)(e.code,{children:"token_id"})," l\xe0m tham s\u1ed1. B\u1ea1n ph\u1ea3i \u0111\xednh k\xe8m \u0111\xfang l\u01b0\u1ee3ng NEAR v\xe0o call n\xe0y \u0111\u1ec3 thanh to\xe1n. Ph\xeda \u0111\u1eb1ng sau, vi\u1ec7c n\xe0y s\u1ebd \u0111\u1ea3m b\u1ea3o kho\u1ea3n ti\u1ec1n g\u1eedi c\u1ee7a b\u1ea1n l\u1edbn h\u01a1n gi\xe1 ni\xeam y\u1ebft v\xe0 call m\u1ed9t private method ",(0,a.jsx)(e.code,{children:"process_purchase"})," s\u1ebd th\u1ef1c hi\u1ec7n m\u1ed9t cross-contract call t\u1edbi NFT contract \u0111\u1ec3 g\u1ecdi function ",(0,a.jsx)(e.code,{children:"nft_transfer_payout"}),". This will transfer the NFT using the ",(0,a.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/ApprovalManagement",children:"approval management"})," standard that you learned about and it will return the ",(0,a.jsx)(e.code,{children:"Payout"})," object which includes royalties."]}),"\n",(0,a.jsxs)(e.p,{children:["Sau \u0111\xf3 marketplace s\u1ebd call ",(0,a.jsx)(e.code,{children:"resolve_purchase"}),", n\u01a1i n\xf3 s\u1ebd ki\u1ec3m tra c\xe1c payout object \u0111\u1ed9c h\u1ea1i v\xe0 sau \u0111\xf3 n\u1ebfu m\u1ecdi th\u1ee9 \u0111\u1ec1u t\u1ed1t, n\xf3 s\u1ebd thanh to\xe1n cho \u0111\xfang cho c\xe1c account."]}),"\n",(0,a.jsx)(i.Ey,{language:"rust",start:"121",end:"151",url:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale.rs"}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"sale_view-rs",children:"sale_view.rs"}),"\n",(0,a.jsxs)(e.p,{children:["The final file is ",(0,a.jsx)(e.a,{href:"https://github.com/near-examples/nft-tutorial/blob/main/market-contract/src/sale_view.rs",children:(0,a.jsx)(e.code,{children:"sale_view.rs"})})," file. \u0110\xe2y l\xe0 n\u01a1i m\u1ed9t v\xe0i method enumeration \u0111\u01b0\u1ee3c ph\xe1c th\u1ea3o. N\xf3 cho ph\xe9p user truy v\u1ea5n c\xe1c th\xf4ng tin quan tr\u1ecdng li\xean quan \u0111\u1ebfn sale."]}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"deployment-and-initialization",children:"Deployment and Initialization"}),"\n",(0,a.jsx)(e.p,{children:"Next, you'll deploy this contract to the network."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"export MARKETPLACE_CONTRACT_ID=<accountId>\nnear account create-account sponsor-by-faucet-service $MARKETPLACE_CONTRACT_ID autogenerate-new-keypair save-to-legacy-keychain network-config testnet create\n"})}),"\n",(0,a.jsx)(e.p,{children:"Using the build script, deploy the contract as you did in the previous tutorials:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"cargo near deploy $MARKETPLACE_CONTRACT_ID with-init-call new json-args '{\"owner_id\": \"'$MARKETPLACE_CONTRACT_ID'\"}' prepaid-gas '100.0 Tgas' attached-deposit '0 NEAR' network-config testnet sign-with-keychain send\n"})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"minting-and-approving",children:"Minting and approving"}),"\n",(0,a.jsx)(e.p,{children:"Let's mint a new NFT token and approve a marketplace contract:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-transaction $NFT_CONTRACT_ID nft_mint json-args \'{"token_id": "token-1", "metadata": {"title": "My Non Fungible Team Token", "description": "The Team Most Certainly Goes :)", "media": "https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif"}, "receiver_id": "\'$NFT_CONTRACT_ID\'"}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'0.1 NEAR\' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"near contract call-function as-transaction $NFT_CONTRACT_ID nft_approve json-args '{\"token_id\": \"token-1\", \"account_id\": \"'$MARKETPLACE_CONTRACT_ID'\"}' prepaid-gas '100.0 Tgas' attached-deposit '0.1 NEAR' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n"})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"listing-nft-on-sale",children:"Listing NFT on sale"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-transaction $MARKETPLACE_CONTRACT_ID list_nft_for_sale json-args \'{"nft_contract_id": "\'$NFT_CONTRACT_ID\'", "token_id": "token-1", "approval_id": 0, "msg": "{\\"sale_conditions\\": \\"1\\"}"}\' prepaid-gas \'300.0 Tgas\' attached-deposit \'0 NEAR\' sign-as $NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"total-supply",children:"T\u1ed5ng l\u01b0\u1ee3ng cung"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 truy v\u1ea5n cho t\u1ed5ng l\u01b0\u1ee3ng cung c\u1ee7a c\xe1c NFT \u0111\u01b0\u1ee3c ni\xeam y\u1ebft tr\xean marketplace, b\u1ea1n c\xf3 th\u1ec3 call function ",(0,a.jsx)(e.code,{children:"get_supply_sales"}),". C\xf3 th\u1ec3 xem v\xed d\u1ee5 d\u01b0\u1edbi \u0111\xe2y."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_supply_sales json-args {} network-config testnet now\n"})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"total-supply-by-owner",children:"T\u1ed5ng l\u01b0\u1ee3ng cung b\u1edfi ch\u1ee7 s\u1edf h\u1eefu"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 truy v\u1ea5n t\u1ed5ng l\u01b0\u1ee3ng cung c\u1ee7a c\xe1c NFT \u0111\u01b0\u1ee3c ni\xeam y\u1ebft b\u1edfi m\u1ed9t ch\u1ee7 s\u1edf h\u1eefu \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh tr\xean marketplace, b\u1ea1n c\xf3 th\u1ec3 call function ",(0,a.jsx)(e.code,{children:"get_supply_by_owner_id"}),". C\xf3 th\u1ec3 xem v\xed d\u1ee5 d\u01b0\u1edbi \u0111\xe2y."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_supply_by_owner_id json-args '{\"account_id\": \"'$NFT_CONTRACT_ID'\"}' network-config testnet now\n"})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"total-supply-by-contract",children:"T\u1ed5ng l\u01b0\u1ee3ng cung theo contract"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 truy v\u1ea5n t\u1ed5ng l\u01b0\u1ee3ng cung c\xe1c NFT thu\u1ed9c v\u1ec1 m\u1ed9t contract ch\u1ec9 \u0111\u1ecbnh n\xe0o \u0111\xf3, b\u1ea1n c\xf3 th\u1ec3 call function ",(0,a.jsx)(e.code,{children:"get_supply_by_nft_contract_id"}),". C\xf3 th\u1ec3 xem v\xed d\u1ee5 d\u01b0\u1edbi \u0111\xe2y."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_supply_by_nft_contract_id json-args '{\"nft_contract_id\": \"'$NFT_CONTRACT_ID'\"}' network-config testnet now\n"})}),"\n",(0,a.jsx)("hr",{className:"subsection"}),"\n",(0,a.jsx)(e.h3,{id:"query-listing-information",children:"Truy v\u1ea5n th\xf4ng tin ni\xeam y\u1ebft"}),"\n",(0,a.jsxs)(e.p,{children:["\u0110\u1ec3 truy v\u1ea5n th\xf4ng tin quan tr\u1ecdng c\u1ee7a m\u1ed9t ni\xeam y\u1ebft \u0111\u01b0\u1ee3c ch\u1ec9 \u0111\u1ecbnh, b\u1ea1n c\xf3 th\u1ec3 call function ",(0,a.jsx)(e.code,{children:"get_sale"}),". N\xf3 y\xeau c\u1ea7u b\u1ea1n truy\u1ec1n v\xe0o ",(0,a.jsx)(e.code,{children:"nft_contract_token"}),". \u0110\xe2y th\u1ef1c ch\u1ea5t l\xe0 \u0111\u1ecbnh danh duy nh\u1ea5t cho vi\u1ec7c sale tr\xean market contract gi\u1ed1ng nh\u01b0 \u0111\xe3 gi\u1ea3i th\xedch tr\u01b0\u1edbc \u0111\xf3. \u0110\u1ecbnh danh n\xe0y bao g\u1ed3m NFT contract, theo sau l\xe0 m\u1ed9t ",(0,a.jsx)(e.code,{children:"DELIMITER"})," v\xe0 sau n\u1eefa l\xe0 token ID. Trong contract n\xe0y, ",(0,a.jsx)(e.code,{children:"DELIMITER"})," \u0111\u01a1n gi\u1ea3n l\xe0 m\u1ed9t d\u1ea5u: ",(0,a.jsx)(e.code,{children:"."})," m\xe0 th\xf4i.  D\u01b0\u1edbi \u0111\xe2y l\xe0 m\u1ed9t v\xed d\u1ee5 v\u1ec1 truy v\u1ea5n n\xe0y."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_sale json-args '{\"nft_contract_token\": \"'$NFT_CONTRACT_ID'.token-1\"}' network-config testnet now\n"})}),"\n",(0,a.jsxs)(e.p,{children:["Ngo\xe0i ra, b\u1ea1n c\xf3 th\u1ec3 truy v\u1ea5n th\xf4ng tin v\u1ec1 ni\xeam y\u1ebft \u0111\u01b0\u1ee3c ph\xe2n trang c\u1ee7a m\u1ed9t ch\u1ee7 s\u1edf h\u1eefu nh\u1ea5t \u0111\u1ecbnh b\u1eb1ng c\xe1ch g\u1ecdi function ",(0,a.jsx)(e.code,{children:"get_sales_by_owner_id"}),"."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_sales_by_owner_id json-args \'{"account_id": "\'$NFT_CONTRACT_ID\'", "from_index": "0", "limit": 5}\' network-config testnet now\n'})}),"\n",(0,a.jsxs)(e.p,{children:["Cu\u1ed1i c\xf9ng, b\u1ea1n c\xf3 th\u1ec3 truy v\u1ea5n th\xf4ng tin v\u1ec1 ni\xeam y\u1ebft \u0111\u01b0\u1ee3c ph\xe2n trang b\u1eaft \u0111\u1ea7u t\u1eeb m\u1ed9t NFT contract nh\u1ea5t \u0111\u1ecbnh b\u1eb1ng c\xe1ch g\u1ecdi function ",(0,a.jsx)(e.code,{children:"get_sales_by_nft_contract_id"}),"."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'near contract call-function as-read-only $MARKETPLACE_CONTRACT_ID get_sales_by_nft_contract_id json-args \'{"nft_contract_id": "\'$NFT_CONTRACT_ID\'", "from_index": "0", "limit": 5}\' network-config testnet now\n'})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsx)(e.h2,{id:"t\u1ed5ng-k\u1ebft",children:"T\u1ed5ng k\u1ebft"}),"\n",(0,a.jsxs)(e.p,{children:["Trong h\u01b0\u1edbng d\u1eabn n\xe0y, b\u1ea1n \u0111\xe3 h\u1ecdc v\u1ec1 nh\u1eefng th\u1ee9 c\u01a1 b\u1ea3n c\u1ee7a m\u1ed9t marketplace contract v\xe0 n\xf3 l\xe0m vi\u1ec7c nh\u01b0 th\u1ebf n\xe0o. B\u1ea1n \u0111\xe3 xem qua file ",(0,a.jsx)(e.a,{href:"#lib-rs",children:"lib.rs"})," v\xe0 \u0111\xe3 t\xecm hi\u1ec3u v\u1ec1 ",(0,a.jsx)(e.a,{href:"#initialization-function",children:"initialization function"}),", th\xeam n\u1eefa l\xe0 ",(0,a.jsx)(e.a,{href:"#storage-management-model",children:"storage management"})," model."]}),"\n",(0,a.jsxs)(e.p,{children:["You went through the ",(0,a.jsx)(e.a,{href:"#listing-logic",children:"NFTs listing process"}),". In addition, you went through some important functions needed after you've listed an NFT. N\xf3 bao g\u1ed3m ",(0,a.jsx)(e.a,{href:"#removing-sales",children:"x\xf3a sale"}),", ",(0,a.jsx)(e.a,{href:"#updating-price",children:"c\u1eadp nh\u1eadt gi\xe1"}),", v\xe0 ",(0,a.jsx)(e.a,{href:"#purchasing-nfts",children:"mua c\xe1c NFT"}),"."]}),"\n",(0,a.jsxs)(e.p,{children:["Cu\u1ed1i c\xf9ng, b\u1ea1n xem qua c\xe1c enumaration method trong file ",(0,a.jsx)(e.a,{href:"#sale_view-rs",children:(0,a.jsx)(e.code,{children:"sale_view"})}),". Ch\xfang cho ph\xe9p b\u1ea1n truy v\u1ea5n th\xf4ng tin quan tr\u1ecdng \u0111\u01b0\u1ee3c t\xecm th\u1ea5y tr\xean marketplace contract."]}),"\n",(0,a.jsxs)(e.p,{children:["B\xe2y gi\u1edd b\u1ea1n \u0111\xe3 c\xf3 hi\u1ec3u bi\u1ebft v\u1eefng ch\u1eafc v\u1ec1 NFT v\xe0 marketplace tr\xean NEAR. Vui l\xf2ng t\xe1ch branch v\xe0 m\u1edf r\u1ed9ng nh\u1eefng contract n\xe0y \u0111\u1ec3 t\u1ea1o b\u1ea5t k\u1ef3 \u1ee9ng d\u1ee5ng th\xfa v\u1ecb n\xe0o b\u1ea1n mu\u1ed1n. In the ",(0,a.jsx)(e.a,{href:"/vi/tutorials/nfts/series",children:"next tutorial"}),", you'll learn how to take the existing NFT contract and optimize it to allow for:"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"Lazy Minting"}),"\n",(0,a.jsx)(e.li,{children:"Creating Collections"}),"\n",(0,a.jsx)(e.li,{children:"Allowlisting functionalities"}),"\n",(0,a.jsx)(e.li,{children:"Optimized Storage Models"}),"\n"]}),"\n",(0,a.jsxs)(e.admonition,{title:"Versioning for this article",type:"note",children:[(0,a.jsx)(e.p,{children:"At the time of this writing, this example works with the following versions:"}),(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["rustc: ",(0,a.jsx)(e.code,{children:"1.77.1"})]}),"\n",(0,a.jsxs)(e.li,{children:["near-cli-rs: ",(0,a.jsx)(e.code,{children:"0.11.0"})]}),"\n",(0,a.jsxs)(e.li,{children:["cargo-near ",(0,a.jsx)(e.code,{children:"0.6.1"})]}),"\n",(0,a.jsxs)(e.li,{children:["NFT standard: ",(0,a.jsx)(e.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Core",children:"NEP171"}),", version ",(0,a.jsx)(e.code,{children:"1.0.0"})]}),"\n"]})]})]})}function d(n={}){const{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(u,{...n})}):u(n)}},85162:(n,e,t)=>{t.d(e,{Z:()=>s});t(67294);var a=t(36905);const r={tabItem:"tabItem_Ymn6"};var i=t(85893);function s(n){var e=n.children,t=n.hidden,s=n.className;return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.Z)(r.tabItem,s),hidden:t,children:e})}},74866:(n,e,t)=>{t.d(e,{Z:()=>_});var a=t(67294),r=t(36905),i=t(12466),s=t(16550),c=t(20469),l=t(91980),o=t(67392),h=t(20812);function u(n){var e,t;return null!=(e=null==(t=a.Children.toArray(n).filter((function(n){return"\n"!==n})).map((function(n){if(!n||(0,a.isValidElement)(n)&&((e=n.props)&&"object"==typeof e&&"value"in e))return n;var e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof n.type?n.type:n.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:t.filter(Boolean))?e:[]}function d(n){var e=n.values,t=n.children;return(0,a.useMemo)((function(){var n=null!=e?e:function(n){return u(n).map((function(n){var e=n.props;return{value:e.value,label:e.label,attributes:e.attributes,default:e.default}}))}(t);return function(n){var e=(0,o.l)(n,(function(n,e){return n.value===e.value}));if(e.length>0)throw new Error('Docusaurus error: Duplicate values "'+e.map((function(n){return n.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(n),n}),[e,t])}function g(n){var e=n.value;return n.tabValues.some((function(n){return n.value===e}))}function p(n){var e=n.queryString,t=void 0!==e&&e,r=n.groupId,i=(0,s.k6)(),c=function(n){var e=n.queryString,t=void 0!==e&&e,a=n.groupId;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:t,groupId:r});return[(0,l._X)(c),(0,a.useCallback)((function(n){if(c){var e=new URLSearchParams(i.location.search);e.set(c,n),i.replace(Object.assign({},i.location,{search:e.toString()}))}}),[c,i])]}function m(n){var e,t,r,i,s=n.defaultValue,l=n.queryString,o=void 0!==l&&l,u=n.groupId,m=d(n),f=(0,a.useState)((function(){return function(n){var e,t=n.defaultValue,a=n.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!g({value:t,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+t+'" but none of its children has the corresponding value. Available values are: '+a.map((function(n){return n.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return t}var r=null!=(e=a.find((function(n){return n.default})))?e:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:s,tabValues:m})})),v=f[0],x=f[1],b=p({queryString:o,groupId:u}),j=b[0],y=b[1],_=(e=function(n){return n?"docusaurus.tab."+n:null}({groupId:u}.groupId),t=(0,h.Nk)(e),r=t[0],i=t[1],[r,(0,a.useCallback)((function(n){e&&i.set(n)}),[e,i])]),T=_[0],N=_[1],k=function(){var n=null!=j?j:T;return g({value:n,tabValues:m})?n:null}();return(0,c.Z)((function(){k&&x(k)}),[k]),{selectedValue:v,selectValue:(0,a.useCallback)((function(n){if(!g({value:n,tabValues:m}))throw new Error("Can't select invalid tab value="+n);x(n),y(n),N(n)}),[y,N,m]),tabValues:m}}var f=t(72389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=t(85893);function b(n){var e=n.className,t=n.block,a=n.selectedValue,s=n.selectValue,c=n.tabValues,l=[],o=(0,i.o5)().blockElementScrollPositionUntilNextRender,h=function(n){var e=n.currentTarget,t=l.indexOf(e),r=c[t].value;r!==a&&(o(e),s(r))},u=function(n){var e,t=null;switch(n.key){case"Enter":h(n);break;case"ArrowRight":var a,r=l.indexOf(n.currentTarget)+1;t=null!=(a=l[r])?a:l[0];break;case"ArrowLeft":var i,s=l.indexOf(n.currentTarget)-1;t=null!=(i=l[s])?i:l[l.length-1]}null==(e=t)||e.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":t},e),children:c.map((function(n){var e=n.value,t=n.label,i=n.attributes;return(0,x.jsx)("li",Object.assign({role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:function(n){return l.push(n)},onKeyDown:u,onClick:h},i,{className:(0,r.Z)("tabs__item",v.tabItem,null==i?void 0:i.className,{"tabs__item--active":a===e}),children:null!=t?t:e}),e)}))})}function j(n){var e=n.lazy,t=n.children,r=n.selectedValue,i=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){var s=i.find((function(n){return n.props.value===r}));return s?(0,a.cloneElement)(s,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map((function(n,e){return(0,a.cloneElement)(n,{key:e,hidden:n.props.value!==r})}))})}function y(n){var e=m(n);return(0,x.jsxs)("div",{className:(0,r.Z)("tabs-container",v.tabList),children:[(0,x.jsx)(b,Object.assign({},e,n)),(0,x.jsx)(j,Object.assign({},e,n))]})}function _(n){var e=(0,f.Z)();return(0,x.jsx)(y,Object.assign({},n,{children:u(n.children)}),String(e))}},71183:(n,e,t)=>{t.d(e,{O2:()=>p,Ey:()=>f,SQ:()=>m});var a=t(67294),r=t(74866),i=t(85162),s=t(74165),c=t(15861),l=t(1841),o=t.n(l),h=t(85893);function u(){return(u=(0,c.Z)((0,s.Z)().mark((function n(e,t,a){var r,i,c,l;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((i=localStorage.getItem(e+"-until"))&&i>Date.now())){n.next=5;break}r=localStorage.getItem(e),n.next=18;break;case 5:return n.prev=5,n.next=8,fetch(e);case 8:return n.next=10,n.sent.text();case 10:r=n.sent,localStorage.setItem(e,r),localStorage.setItem(e+"-until",Date.now()+6e4),n.next=18;break;case 15:return n.prev=15,n.t0=n.catch(5),n.abrupt("return","Error fetching code, please try reloading");case 18:return c=r.split("\n"),t=t?Number(t)-1:0,a=a?Number(a):c.length,c=c.slice(t,a),l=c.reduce((function(n,e){if(0===e.length)return n;var t=e.match(/^\s+/);return t?Math.min(n,t[0].length):0}),1/0),n.abrupt("return",c.map((function(n){return n.slice(l)})).join("\n"));case 24:case"end":return n.stop()}}),n,null,[[5,15]])})))).apply(this,arguments)}const d=function(n){var e=n.url,t=n.start,r=n.end,i=n.language,s=n.fname,c=n.metastring,l=(0,a.useState)("Loading..."),d=l[0],g=l[1];return(0,a.useEffect)((function(){var n=function(n){var e=n.slice(n.indexOf("https")).split("#"),t=e[0],a=(e[1],new URL(t).pathname.split("/").slice(1)),r=a[0],i=a[1];return a[2],"https://raw.githubusercontent.com/"+r+"/"+i+"/"+a[3]+"/"+a.slice(4).join("/")}(e),a=function(n,e,t){return u.apply(this,arguments)}(n,t,r);a.then((function(n){return g(n)}))})),(0,h.jsxs)("div",{fname:s,children:[(0,h.jsx)(o(),{language:i,metastring:c+" showLineNumbers",children:d}),(0,h.jsx)("div",{style:{fontSize:"0.9em",fontWeight:600,color:"rgb(14, 117, 221)",textAlign:"center",paddingBottom:"13px",textDecoration:"underline"},children:(0,h.jsx)("a",{href:e,target:"_blank",rel:"noreferrer noopener",children:"See full example on GitHub"})})]})};var g={rust:"\ud83e\udd80 Rust",js:"\ud83c\udf10 Javascript",ts:"\ud83c\udf10 Typescript"};function p(n){var e=n.children;return Array.isArray(e)||(e=[e]),(0,h.jsx)(r.Z,{className:"language-tabs",groupId:"code-tabs",children:e.map((function(n,e){return(0,h.jsx)(i.Z,{value:n.props.value,label:g[n.props.value],children:n})}))})}function m(n){var e=n.children,t=n.language,a=n.showSingleFName;return Array.isArray(e)||(e=[e]),e=e.map((function(n){return function(n,e){var t=n.props,a=(t.children,t.url),r=t.start,i=t.end,s=t.fname;if(n.type===f)return f({url:a,start:r,end:i,language:e,fname:s});return n}(n,t)})),1!=e.length||a?(0,h.jsx)(r.Z,{className:"file-tabs",children:e.map((function(n,e){return(0,h.jsx)(i.Z,{value:e,label:n.props.fname,children:n})}))}):(0,h.jsx)(i.Z,{value:0,label:e[0].props.fname,children:e[0]})}function f(n){var e=n.url,t=n.start,a=n.end,r=n.language,i=n.fname,s=n.metastring;return d({url:e,start:t,end:a,language:r,fname:i,metastring:s})}}}]);
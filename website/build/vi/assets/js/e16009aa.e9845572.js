"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7148],{50282:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>u});var a=n(85893),r=n(11151),o=n(71183);const i={id:"royalty",title:"Royalty",sidebar_label:"Royalty"},l=void 0,c={id:"tutorials/nfts/royalty",title:"Royalty",description:"Trong h\u01b0\u1edbng d\u1eabn n\xe0y b\u1ea1n s\u1ebd ti\u1ebfp t\u1ee5c build non-fungible token (NFT) smart contract c\u1ee7a m\xecnh, v\xe0 t\xecm hi\u1ec3u c\xe1ch tri\u1ec3n khai c\xe1c perpetual royalty v\xe0o c\xe1c NFT. Vi\u1ec7c n\xe0y s\u1ebd cho ph\xe9p m\u1ecdi ng\u01b0\u1eddi nh\u1eadn \u0111\u01b0\u1ee3c ph\u1ea7n tr\u0103m c\u1ee7a gi\xe1 mua khi NFT \u0111\u01b0\u1ee3c b\xe1n.",source:"@site/i18n/vi/docusaurus-plugin-content-docs/current/3.tutorials/nfts/6-royalty.md",sourceDirName:"3.tutorials/nfts",slug:"/tutorials/nfts/royalty",permalink:"/vi/tutorials/nfts/royalty",draft:!1,unlisted:!1,editUrl:"https://github.com/near/docs/edit/master/website/../docs/3.tutorials/nfts/6-royalty.md",tags:[],version:"current",lastUpdatedBy:"Github Actions",lastUpdatedAt:1719825734e3,sidebarPosition:6,frontMatter:{id:"royalty",title:"Royalty",sidebar_label:"Royalty"},sidebar:"tutorials",previous:{title:"Marketplace",permalink:"/vi/tutorials/nfts/marketplace"},next:{title:"Lazy Minting, Collections, and More!",permalink:"/vi/tutorials/nfts/series"}},s={},u=[{value:"Gi\u1edbi thi\u1ec7u",id:"gi\u1edbi-thi\u1ec7u",level:2},{value:"Suy ngh\u0129 v\u1ec1 v\u1ea5n \u0111\u1ec1",id:"suy-ngh\u0129-v\u1ec1-v\u1ea5n-\u0111\u1ec1",level:2},{value:"M\u1edf r\u1ed9ng gi\u1ea3i ph\xe1p hi\u1ec7n t\u1ea1i",id:"m\u1edf-r\u1ed9ng-gi\u1ea3i-ph\xe1p-hi\u1ec7n-t\u1ea1i",level:3},{value:"C\xe1c s\u1eeda \u0111\u1ed5i v\u1edbi contract",id:"c\xe1c-s\u1eeda-\u0111\u1ed5i-v\u1edbi-contract",level:2},{value:"Internal helper function",id:"internal-helper-function",level:3},{value:"C\xe1c royalty",id:"c\xe1c-royalty",level:3},{value:"C\xe1c perpetual royalty",id:"c\xe1c-perpetual-royalty",level:3},{value:"Th\xeam royalty object v\xe0o c\xe1c tri\u1ec3n khai c\u1ea5u tr\xfac",id:"th\xeam-royalty-object-v\xe0o-c\xe1c-tri\u1ec3n-khai-c\u1ea5u-tr\xfac",level:3},{value:"Deploy contract",id:"redeploying-contract",level:2},{value:"Deployment and initialization",id:"deployment-and-initialization",level:3},{value:"Minting",id:"minting",level:3},{value:"NFT payout",id:"nft-payout",level:3},{value:"T\u1ed5ng k\u1ebft",id:"t\u1ed5ng-k\u1ebft",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.p,{children:"Trong h\u01b0\u1edbng d\u1eabn n\xe0y b\u1ea1n s\u1ebd ti\u1ebfp t\u1ee5c build non-fungible token (NFT) smart contract c\u1ee7a m\xecnh, v\xe0 t\xecm hi\u1ec3u c\xe1ch tri\u1ec3n khai c\xe1c perpetual royalty v\xe0o c\xe1c NFT. Vi\u1ec7c n\xe0y s\u1ebd cho ph\xe9p m\u1ecdi ng\u01b0\u1eddi nh\u1eadn \u0111\u01b0\u1ee3c ph\u1ea7n tr\u0103m c\u1ee7a gi\xe1 mua khi NFT \u0111\u01b0\u1ee3c b\xe1n."}),"\n",(0,a.jsx)(t.h2,{id:"gi\u1edbi-thi\u1ec7u",children:"Gi\u1edbi thi\u1ec7u"}),"\n",(0,a.jsxs)(t.p,{children:["B\xe2y gi\u1edd, b\u1ea1n s\u1ebd c\xf3 m\u1ed9t NFT contract ho\xe0n ch\u1ec9nh \u0111\u1ea7y \u0111\u1ee7, ngo\u1ea1i tr\u1eeb vi\u1ec7c h\u1ed7 tr\u1ee3 royalty. To get started, go to the ",(0,a.jsx)(t.code,{children:"nft-contract-approval/"})," folder from our ",(0,a.jsx)(t.a,{href:"https://github.com/near-examples/nft-tutorial/",children:"GitHub repository"}),", or continue your work from the previous tutorials."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"cd nft-contract-approval/\n"})}),"\n",(0,a.jsxs)(t.admonition,{type:"tip",children:[(0,a.jsxs)(t.mdxAdmonitionTitle,{children:["If you wish to see the finished code for this ",(0,a.jsx)(t.em,{children:"Royalty"})," tutorial, you can find it in the ",(0,a.jsx)(t.code,{children:"nft-contract-royalty"})," folder. :::"]}),(0,a.jsx)(t.hr,{}),(0,a.jsx)(t.h2,{id:"suy-ngh\u0129-v\u1ec1-v\u1ea5n-\u0111\u1ec1",children:"Suy ngh\u0129 v\u1ec1 v\u1ea5n \u0111\u1ec1"}),(0,a.jsxs)(t.p,{children:["\u0110\u1ec3 tri\u1ec3n khai t\xednh n\u0103ng n\xe0y, tr\u01b0\u1edbc ti\xean b\u1ea1n c\u1ea7n hi\u1ec3u c\xe1c NFT \u0111\u01b0\u1ee3c b\xe1n nh\u01b0 th\u1ebf n\xe0o. Trong b\xe0i h\u01b0\u1edbng d\u1eabn tr\u01b0\u1edbc, b\u1ea1n \u0111\xe3 th\u1ea5y c\xe1ch ai \u0111\xf3 c\xf3 m\u1ed9t NFT v\xe0 h\u1ecd c\xf3 th\u1ec3 \u0111\u01b0a n\xf3 l\xean marketplace b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng function ",(0,a.jsx)(t.code,{children:"nft_approve"})," k\xe8m theo m\u1ed9t message c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i m\xe3 \u0111\xfang c\xe1ch. Khi m\u1ed9t user mua NFT c\u1ee7a b\u1ea1n tr\xean marketplace, \u0111i\u1ec1u g\xec s\u1ebd x\u1ea3y ra?"]}),(0,a.jsxs)(t.p,{children:["S\u1eed d\u1ee5ng ki\u1ebfn th\u1ee9c b\u1ea1n \u0111ang c\xf3, m\u1ed9t k\u1ebft lu\u1eadn h\u1ee3p l\xfd s\u1ebd l\xe0 marketplace transfer NFT t\u1edbi ng\u01b0\u1eddi mua b\u1eb1ng c\xe1ch th\u1ef1c hi\u1ec7n m\u1ed9t cross-contract call v\xe0 g\u1ecdi NFT contract c\u1ee7a method ",(0,a.jsx)(t.code,{children:"nft_transfer"}),". Khi function \u0111\xf3 k\u1ebft th\xfac, marketplace s\u1ebd thanh to\xe1n cho ng\u01b0\u1eddi b\xe1n s\u1ed1 ti\u1ec1n \u0111\xfang b\u1eb1ng ng\u01b0\u1eddi mua \u0111\xe3 tr\u1ea3."]}),(0,a.jsx)(t.p,{children:"B\xe2y gi\u1edd h\xe3y ngh\u0129 v\u1ec1 c\xe1ch vi\u1ec7c n\xe0y c\xf3 th\u1ec3 \u0111\u01b0\u1ee3c m\u1edf r\u1ed9ng \u0111\u1ec3 cho ph\xe9p c\u1eaft gi\u1ea3m kho\u1ea3n thanh to\xe1n cho c\xe1c account kh\xe1c kh\xf4ng ch\u1ec9 l\xe0 ng\u01b0\u1eddi b\xe1n."}),(0,a.jsx)("hr",{class:"subsection"}),(0,a.jsx)(t.h3,{id:"m\u1edf-r\u1ed9ng-gi\u1ea3i-ph\xe1p-hi\u1ec7n-t\u1ea1i",children:"M\u1edf r\u1ed9ng gi\u1ea3i ph\xe1p hi\u1ec7n t\u1ea1i"}),(0,a.jsxs)(t.p,{children:["Since perpetual royalties will be on a per-token basis, it's safe to assume that you should be changing the ",(0,a.jsx)(t.code,{children:"Token"})," and ",(0,a.jsx)(t.code,{children:"JsonToken"})," structs. You need some way of keeping track of what percentage each account with a royalty should have. If you introduce a map of an account to an integer, that should do the trick."]}),(0,a.jsx)(t.p,{children:"Now, you need some way to relay that information to the marketplace. This method should be able to transfer the NFT exactly like the old solution but with the added benefit of telling the marketplace exactly what accounts should be paid what amounts. If you implement a method that transfers the NFT and then calculates exactly what accounts get paid and to what amount based on a passed-in balance, that should work nicely."}),(0,a.jsxs)(t.p,{children:["This is what the ",(0,a.jsx)(t.a,{href:"https://nomicon.io/Standards/NonFungibleToken/Payout",children:"royalty standards"})," outlined. Let's now move on and modify our smart contract to introduce this behavior."]}),(0,a.jsx)(t.hr,{}),(0,a.jsx)(t.h2,{id:"c\xe1c-s\u1eeda-\u0111\u1ed5i-v\u1edbi-contract",children:"C\xe1c s\u1eeda \u0111\u1ed5i v\u1edbi contract"}),(0,a.jsxs)(t.p,{children:["The first thing you'll want to do is add the royalty information to the structs. Open the ",(0,a.jsx)(t.code,{children:"nft-contract-approval/src/metadata.rs"})," file and add ",(0,a.jsx)(t.code,{children:"royalty"})," to the ",(0,a.jsx)(t.code,{children:"Token"})," struct:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:"pub royalty: HashMap<AccountId, u32>,\n"})}),(0,a.jsxs)(t.p,{children:["Second, you'll want to add ",(0,a.jsx)(t.code,{children:"royalty"})," to the ",(0,a.jsx)(t.code,{children:"JsonToken"})," struct as well:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:"pub royalty: HashMap<AccountId, u32>,\n"})}),(0,a.jsx)("hr",{class:"subsection"}),(0,a.jsx)(t.h3,{id:"internal-helper-function",children:"Internal helper function"}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"royalty_to_payout"})}),(0,a.jsxs)(t.p,{children:["To simplify the payout calculation, let's add a helper ",(0,a.jsx)(t.code,{children:"royalty_to_payout"})," function to ",(0,a.jsx)(t.code,{children:"src/internal.rs"}),". This will convert a percentage to the actual amount that should be paid. In order to allow for percentages less than 1%, you can give 100% a value of ",(0,a.jsx)(t.code,{children:"10,000"}),". This means that the minimum percentage you can give out is 0.01%, or ",(0,a.jsx)(t.code,{children:"1"}),". For example, if you wanted the account ",(0,a.jsx)(t.code,{children:"benji.testnet"})," to have a perpetual royalty of 20%, you would insert the pair ",(0,a.jsx)(t.code,{children:'"benji.testnet": 2000'})," into the payout map."]}),(0,a.jsx)(o.Ey,{language:"rust",start:"5",end:"8",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/internal.rs"}),(0,a.jsxs)(t.p,{children:["If you were to use the ",(0,a.jsx)(t.code,{children:"royalty_to_payout"})," function and pass in ",(0,a.jsx)(t.code,{children:"2000"})," as the ",(0,a.jsx)(t.code,{children:"royalty_percentage"})," and an ",(0,a.jsx)(t.code,{children:"amount_to_pay"})," of 1 NEAR, it would return a value of 0.2 NEAR."]}),(0,a.jsx)("hr",{class:"subsection"}),(0,a.jsx)(t.h3,{id:"c\xe1c-royalty",children:"C\xe1c royalty"}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"nft_payout"})}),(0,a.jsxs)(t.p,{children:["Let's now implement a method to check what accounts will be paid out for an NFT given an amount, or balance. Open the ",(0,a.jsx)(t.code,{children:"nft-contract/src/royalty.rs"})," file, and modify the ",(0,a.jsx)(t.code,{children:"nft_payout"})," function as shown."]}),(0,a.jsx)(o.Ey,{language:"rust",start:"22",end:"67",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/royalty.rs"}),(0,a.jsxs)(t.p,{children:["This function will loop through the token's royalty map and take the balance and convert that to a payout using the ",(0,a.jsx)(t.code,{children:"royalty_to_payout"})," function you created earlier. It will give the owner of the token whatever is left from the total royalties. As an example:"]}),(0,a.jsx)(t.p,{children:"You have a token with the following royalty field:"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:'Token {\n    owner_id: "damian",\n    royalty: {\n        "benji": 1000,\n        "josh": 500,\n        "mike": 2000\n    }\n}\n'})}),(0,a.jsxs)(t.p,{children:["If a user were to call ",(0,a.jsx)(t.code,{children:"nft_payout"})," on the token and pass in a balance of 1 NEAR, it would loop through the token's royalty field and insert the following into the payout object:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-rust",children:'Payout {\n    payout: {\n        "benji": 0.1 NEAR,\n        "josh": 0.05 NEAR,\n        "mike": 0.2 NEAR\n    }\n}\n'})}),(0,a.jsxs)(t.p,{children:["At the very end, it will insert ",(0,a.jsx)(t.code,{children:"damian"})," into the payout object and give him ",(0,a.jsx)(t.code,{children:"1 NEAR - 0.1 - 0.05 - 0.2 = 0.65 NEAR"}),"."]}),(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"nft_transfer_payout"})}),(0,a.jsx)(t.p,{children:"Now that you know how payouts are calculated, it's time to create the function that will transfer the NFT and return the payout to the marketplace."}),(0,a.jsx)(o.Ey,{language:"rust",start:"68",end:"135",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/royalty.rs"}),(0,a.jsx)("hr",{class:"subsection"}),(0,a.jsx)(t.h3,{id:"c\xe1c-perpetual-royalty",children:"C\xe1c perpetual royalty"}),(0,a.jsxs)(t.p,{children:["To add support for perpetual royalties, let's edit the ",(0,a.jsx)(t.code,{children:"src/mint.rs"})," file. First, add an optional parameter for perpetual royalties. This is what will determine what percentage goes to which accounts when the NFT is purchased. You will also need to create and insert the royalty to be put in the ",(0,a.jsx)(t.code,{children:"Token"})," object:"]}),(0,a.jsx)(o.Ey,{language:"rust",start:"6",end:"80",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/mint.rs"}),(0,a.jsxs)(t.p,{children:["Next, you can use the CLI to query the new ",(0,a.jsx)(t.code,{children:"nft_payout"})," function and validate that it works correctly."]}),(0,a.jsx)(t.h3,{id:"th\xeam-royalty-object-v\xe0o-c\xe1c-tri\u1ec3n-khai-c\u1ea5u-tr\xfac",children:"Th\xeam royalty object v\xe0o c\xe1c tri\u1ec3n khai c\u1ea5u tr\xfac"}),(0,a.jsxs)(t.p,{children:["Since you've added a new field to your ",(0,a.jsx)(t.code,{children:"Token"})," and ",(0,a.jsx)(t.code,{children:"JsonToken"})," structs, you need to edit your implementations accordingly. Move to the ",(0,a.jsx)(t.code,{children:"nft-contract/src/internal.rs"})," file and edit the part of your ",(0,a.jsx)(t.code,{children:"internal_transfer"})," function that creates the new ",(0,a.jsx)(t.code,{children:"Token"})," object:"]}),(0,a.jsx)(o.Ey,{language:"rust",start:"184",end:"192",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/internal.rs"}),(0,a.jsxs)(t.p,{children:["Once that's finished, move to the ",(0,a.jsx)(t.code,{children:"nft-contract-approval/src/nft_core.rs"})," file. You need to edit your implementation of ",(0,a.jsx)(t.code,{children:"nft_token"})," so that the ",(0,a.jsx)(t.code,{children:"JsonToken"})," sends back the new royalty information."]}),(0,a.jsx)(o.Ey,{language:"rust",start:"160",end:"177",url:"https://github.com/near-examples/nft-tutorial/blob/main/nft-contract-royalty/src/nft_core.rs"}),(0,a.jsx)(t.hr,{}),(0,a.jsx)(t.h2,{id:"redeploying-contract",children:"Deploy contract"}),(0,a.jsx)(t.p,{children:"As you saw in the previous tutorial, adding changes like these will cause problems when redeploying. Since these changes affect all the other tokens and the state won't be able to automatically be inherited by the new code, simply redeploying the contract will lead to errors. For this reason, you'll create a new account again."}),(0,a.jsx)(t.h3,{id:"deployment-and-initialization",children:"Deployment and initialization"}),(0,a.jsx)(t.p,{children:"Next, you'll deploy this contract to the network."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"export ROYALTY_NFT_CONTRACT_ID=<accountId>\nnear account create-account sponsor-by-faucet-service $ROYALTY_NFT_CONTRACT_ID autogenerate-new-keypair save-to-legacy-keychain network-config testnet create\n"})}),(0,a.jsx)(t.p,{children:"Using the cargo-near, deploy and initialize the contract as you did in the previous tutorials:"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"cargo near deploy $ROYALTY_NFT_CONTRACT_ID with-init-call new_default_meta json-args '{\"owner_id\": \"'$ROYALTY_NFT_CONTRACT_ID'\"}' prepaid-gas '100.0 Tgas' attached-deposit '0 NEAR' network-config testnet sign-with-keychain send\n"})}),(0,a.jsx)(t.h3,{id:"minting",children:"Minting"}),(0,a.jsxs)(t.p,{children:["Ti\u1ebfp theo, b\u1ea1n s\u1ebd c\u1ea7n mint m\u1ed9t token. B\u1eb1ng c\xe1ch ch\u1ea1y command n\xe0y, b\u1ea1n s\u1ebd mint m\u1ed9t token v\u1edbi token ID ",(0,a.jsx)(t.code,{children:'"royalty-token"'})," v\xe0 ng\u01b0\u1eddi nh\u1eadn s\u1ebd l\xe0 account m\u1edbi c\u1ee7a b\u1ea1n. Ngo\xe0i ra, b\u1ea1n \u0111ang truy\u1ec1n v\xe0o m\u1ed9t map v\u1edbi hai account s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c perpetual royalty b\u1ea5t c\u1ee9 khi n\xe0o token c\u1ee7a b\u1ea1n \u0111\u01b0\u1ee3c b\xe1n."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'near contract call-function as-transaction $ROYALTY_NFT_CONTRACT_ID nft_mint json-args \'{"token_id": "royalty-token", "metadata": {"title": "Royalty Token", "description": "testing out the new royalty extension of the standard", "media": "https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif"}, "receiver_id": "\'$ROYALTY_NFT_CONTRACT_ID\'", "perpetual_royalties": {"benjiman.testnet": 2000, "mike.testnet": 1000, "josh.testnet": 500}}\' prepaid-gas \'100.0 Tgas\' attached-deposit \'0.1 NEAR\' sign-as $ROYALTY_NFT_CONTRACT_ID network-config testnet sign-with-legacy-keychain send\n'})}),(0,a.jsx)(t.p,{children:"B\u1ea1n c\xf3 th\u1ec3 ki\u1ec3m tra xem m\u1ecdi th\u1ee9 c\xf3 di\u1ec5n ra b\xecnh th\u01b0\u1eddng hay kh\xf4ng b\u1eb1ng c\xe1ch g\u1ecdi m\u1ed9t trong c\xe1c enumeration function:"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'near contract call-function as-read-only $ROYALTY_NFT_CONTRACT_ID nft_tokens_for_owner json-args \'{"account_id": "\'$ROYALTY_NFT_CONTRACT_ID\'", "limit": 10}\' network-config testnet now\n'})}),(0,a.jsx)(t.p,{children:"N\xf3 s\u1ebd tr\u1ea3 v\u1ec1 m\u1ed9t output tr\xf4ng gi\u1ed1ng nh\u01b0 sau:"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'[\n  {\n    "token_id": "royalty-token",\n    "owner_id": "royalty.goteam.examples.testnet",\n    "metadata": {\n      "title": "Royalty Token",\n      "description": "testing out the new royalty extension of the standard",\n      "media": "https://bafybeiftczwrtyr3k7a2k4vutd3amkwsmaqyhrdzlhvpt33dyjivufqusq.ipfs.dweb.link/goteam-gif.gif",\n      "media_hash": null,\n      "copies": null,\n      "issued_at": null,\n      "expires_at": null,\n      "starts_at": null,\n      "updated_at": null,\n      "extra": null,\n      "reference": null,\n      "reference_hash": null\n    },\n    "approved_account_ids": {},\n    "royalty": {\n      "josh.testnet": 500,\n      "benjiman.testnet": 2000,\n      "mike.testnet": 1000\n    }\n  }\n]\n'})}),(0,a.jsx)(t.p,{children:"L\u01b0u \xfd, b\xe2y gi\u1edd l\xe0m th\u1ebf n\xe0o \u0111\u1ec3 c\xf3 m\u1ed9t royalty field ch\u1ee9a 3 account s\u1ebd nh\u1eadn \u0111\u01b0\u1ee3c t\u1ed5ng c\u1ed9ng 35% t\u1ed5ng doanh thu c\u1ee7a NFT n\xe0y? C\xf3 v\u1ebb nh\u01b0 n\xf3 ho\u1ea1t \u0111\u1ed9ng! Ti\u1ebfn l\xean c\xe1c b\u1ea1n :)"}),(0,a.jsx)(t.h3,{id:"nft-payout",children:"NFT payout"}),(0,a.jsxs)(t.p,{children:["Let's calculate the payout for the ",(0,a.jsx)(t.code,{children:'"royalty-token"'})," NFT, given a balance of 100 yoctoNEAR. \u0110i\u1ec1u quan tr\u1ecdng c\u1ea7n l\u01b0u \xfd l\xe0 s\u1ed1 d\u01b0 \u0111\u01b0\u1ee3c truy\u1ec1n v\xe0o function ",(0,a.jsx)(t.code,{children:"nft_payout"})," mong mu\u1ed1n t\xednh b\u1eb1ng yoctoNEAR."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'near contract call-function as-read-only $ROYALTY_NFT_CONTRACT_ID nft_payout json-args \'{"token_id": "royalty-token", "balance": "100", "max_len_payout": 100}\' network-config testnet now\n'})}),(0,a.jsx)(t.p,{children:"C\xe2u l\u1ec7nh n\xe0y s\u1ebd tr\u1ea3 v\u1ec1 m\u1ed9t ouput ki\u1ec3u nh\u01b0 sau:"}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-js",children:"{\n  payout: {\n    'josh.testnet': '5',\n    'royalty.goteam.examples.testnet': '65',\n    'mike.testnet': '10',\n    'benjiman.testnet': '20'\n  }\n}\n"})}),(0,a.jsxs)(t.p,{children:["If the NFT was sold for 100 yoctoNEAR, josh would get 5, Benji would get 20, mike would get 10, and the owner, in this case ",(0,a.jsx)(t.code,{children:"royalty.goteam.examples.testnet"})," would get the rest: 65."]}),(0,a.jsx)(t.h2,{id:"t\u1ed5ng-k\u1ebft",children:"T\u1ed5ng k\u1ebft"}),(0,a.jsx)(t.p,{children:"\u1ede th\u1eddi \u0111i\u1ec3m n\xe0y b\u1ea1n \u0111\xe3 c\xf3 m\u1ecdi th\u1ee9 b\u1ea1n c\u1ea7n cho m\u1ed9t NFT contract \u0111\u1ea7y \u0111\u1ee7 t\xednh n\u0103ng \u0111\u1ec3 t\u01b0\u01a1ng t\xe1c v\u1edbi c\xe1c marketplace. Ti\xeau chu\u1ea9n c\xf2n l\u1ea1i cu\u1ed1i c\xf9ng m\xe0 b\u1ea1n c\xf3 th\u1ec3 th\u1ef1c hi\u1ec7n l\xe0 c\xe1c ti\xeau chu\u1ea9n event. N\xf3 cho ph\xe9p c\xe1c indexer bi\u1ebft c\xe1c function n\xe0o \u0111ang \u0111\u01b0\u1ee3c call, qua \u0111\xf3 gi\xfap vi\u1ec7c theo d\xf5i th\xf4ng tin \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 hi\u1ec3n th\u1ecb trong collectibles tab \u1edf wallet d\u1ec5 d\xe0ng v\xe0 tin c\u1eady h\u01a1n."}),(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsxs)(t.mdxAdmonitionTitle,{children:["remember If you want to see the finished code from this tutorial, you can go to the ",(0,a.jsx)(t.code,{children:"nft-contract-royalty"})," folder. :::"]}),(0,a.jsxs)(t.admonition,{title:"Versioning for this article",type:"note",children:[(0,a.jsx)(t.p,{children:"At the time of this writing, this example works with the following versions:"}),(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["rustc: ",(0,a.jsx)(t.code,{children:"1.77.1"})]}),"\n",(0,a.jsxs)(t.li,{children:["near-cli-rs: ",(0,a.jsx)(t.code,{children:"0.11.0"})]}),"\n",(0,a.jsxs)(t.li,{children:["cargo-near ",(0,a.jsx)(t.code,{children:"0.6.1"})]}),"\n",(0,a.jsxs)(t.li,{children:["NFT standard: ",(0,a.jsx)(t.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Core",children:"NEP171"}),", version ",(0,a.jsx)(t.code,{children:"1.0.0"})]}),"\n",(0,a.jsxs)(t.li,{children:["Enumeration standard: ",(0,a.jsx)(t.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Enumeration",children:"NEP181"}),", version ",(0,a.jsx)(t.code,{children:"1.0.0"})]}),"\n",(0,a.jsxs)(t.li,{children:["Royalties standard: ",(0,a.jsx)(t.a,{href:"https://nomicon.io/Standards/Tokens/NonFungibleToken/Payout",children:"NEP199"}),", version ",(0,a.jsx)(t.code,{children:"2.0.0"})]}),"\n"]})]})]})]})]})}function d(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},85162:(e,t,n)=>{n.d(t,{Z:()=>i});n(67294);var a=n(36905);const r={tabItem:"tabItem_Ymn6"};var o=n(85893);function i(e){var t=e.children,n=e.hidden,i=e.className;return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.Z)(r.tabItem,i),hidden:n,children:t})}},74866:(e,t,n)=>{n.d(t,{Z:()=>k});var a=n(67294),r=n(36905),o=n(12466),i=n(16550),l=n(20469),c=n(91980),s=n(67392),u=n(20812);function h(e){var t,n;return null!=(t=null==(n=a.Children.toArray(e).filter((function(e){return"\n"!==e})).map((function(e){if(!e||(0,a.isValidElement)(e)&&((t=e.props)&&"object"==typeof t&&"value"in t))return e;var t;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})))?void 0:n.filter(Boolean))?t:[]}function d(e){var t=e.values,n=e.children;return(0,a.useMemo)((function(){var e=null!=t?t:function(e){return h(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}(n);return function(e){var t=(0,s.lx)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function p(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function y(e){var t=e.queryString,n=void 0!==t&&t,r=e.groupId,o=(0,i.k6)(),l=function(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:r});return[(0,c._X)(l),(0,a.useCallback)((function(e){if(l){var t=new URLSearchParams(o.location.search);t.set(l,e),o.replace(Object.assign({},o.location,{search:t.toString()}))}}),[l,o])]}function m(e){var t,n,r,o,i=e.defaultValue,c=e.queryString,s=void 0!==c&&c,h=e.groupId,m=d(e),g=(0,a.useState)((function(){return function(e){var t,n=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var r=null!=(t=a.find((function(e){return e.default})))?t:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:i,tabValues:m})})),f=g[0],x=g[1],j=y({queryString:s,groupId:h}),b=j[0],v=j[1],k=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:h}.groupId),n=(0,u.Nk)(t),r=n[0],o=n[1],[r,(0,a.useCallback)((function(e){t&&o.set(e)}),[t,o])]),w=k[0],T=k[1],N=function(){var e=null!=b?b:w;return p({value:e,tabValues:m})?e:null}();return(0,l.Z)((function(){N&&x(N)}),[N]),{selectedValue:f,selectValue:(0,a.useCallback)((function(e){if(!p({value:e,tabValues:m}))throw new Error("Can't select invalid tab value="+e);x(e),v(e),T(e)}),[v,T,m]),tabValues:m}}var g=n(72389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(85893);function j(e){var t=e.className,n=e.block,a=e.selectedValue,i=e.selectValue,l=e.tabValues,c=[],s=(0,o.o5)().blockElementScrollPositionUntilNextRender,u=function(e){var t=e.currentTarget,n=c.indexOf(t),r=l[n].value;r!==a&&(s(t),i(r))},h=function(e){var t,n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":var a,r=c.indexOf(e.currentTarget)+1;n=null!=(a=c[r])?a:c[0];break;case"ArrowLeft":var o,i=c.indexOf(e.currentTarget)-1;n=null!=(o=c[i])?o:c[c.length-1]}null==(t=n)||t.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.Z)("tabs",{"tabs--block":n},t),children:l.map((function(e){var t=e.value,n=e.label,o=e.attributes;return(0,x.jsx)("li",Object.assign({role:"tab",tabIndex:a===t?0:-1,"aria-selected":a===t,ref:function(e){return c.push(e)},onKeyDown:h,onClick:u},o,{className:(0,r.Z)("tabs__item",f.tabItem,null==o?void 0:o.className,{"tabs__item--active":a===t}),children:null!=n?n:t}),t)}))})}function b(e){var t=e.lazy,n=e.children,o=e.selectedValue,i=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){var l=i.find((function(e){return e.props.value===o}));return l?(0,a.cloneElement)(l,{className:(0,r.Z)("margin-top--md",l.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==o})}))})}function v(e){var t=m(e);return(0,x.jsxs)("div",{className:(0,r.Z)("tabs-container",f.tabList),children:[(0,x.jsx)(j,Object.assign({},t,e)),(0,x.jsx)(b,Object.assign({},t,e))]})}function k(e){var t=(0,g.Z)();return(0,x.jsx)(v,Object.assign({},e,{children:h(e.children)}),String(t))}},71183:(e,t,n)=>{n.d(t,{O2:()=>y,Ey:()=>g,SQ:()=>m});var a=n(67294),r=n(74866),o=n(85162),i=n(74165),l=n(15861),c=n(1841),s=n.n(c),u=n(85893);function h(){return(h=(0,l.Z)((0,i.Z)().mark((function e(t,n,a){var r,o,l,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((o=localStorage.getItem(t+"-until"))&&o>Date.now())){e.next=5;break}r=localStorage.getItem(t),e.next=18;break;case 5:return e.prev=5,e.next=8,fetch(t);case 8:return e.next=10,e.sent.text();case 10:r=e.sent,localStorage.setItem(t,r),localStorage.setItem(t+"-until",Date.now()+6e4),e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(5),e.abrupt("return","Error fetching code, please try reloading");case 18:return l=r.split("\n"),n=n?Number(n)-1:0,a=a?Number(a):l.length,l=l.slice(n,a),c=l.reduce((function(e,t){if(0===t.length)return e;var n=t.match(/^\s+/);return n?Math.min(e,n[0].length):0}),1/0),e.abrupt("return",l.map((function(e){return e.slice(c)})).join("\n"));case 24:case"end":return e.stop()}}),e,null,[[5,15]])})))).apply(this,arguments)}const d=function(e){var t=e.url,n=e.start,r=e.end,o=e.language,i=e.fname,l=e.metastring,c=(0,a.useState)("Loading..."),d=c[0],p=c[1];return(0,a.useEffect)((function(){var e=function(e){var t=e.slice(e.indexOf("https")).split("#"),n=t[0],a=(t[1],new URL(n).pathname.split("/").slice(1)),r=a[0],o=a[1];return a[2],"https://raw.githubusercontent.com/"+r+"/"+o+"/"+a[3]+"/"+a.slice(4).join("/")}(t),a=function(e,t,n){return h.apply(this,arguments)}(e,n,r);a.then((function(e){return p(e)}))})),(0,u.jsxs)("div",{fname:i,children:[(0,u.jsx)(s(),{language:o,metastring:l+" showLineNumbers",children:d}),(0,u.jsx)("div",{style:{fontSize:"0.9em",fontWeight:600,color:"rgb(14, 117, 221)",textAlign:"center",paddingBottom:"13px",textDecoration:"underline"},children:(0,u.jsx)("a",{href:t,target:"_blank",rel:"noreferrer noopener",children:"See full example on GitHub"})})]})};var p={rust:"\ud83e\udd80 Rust",js:"\ud83c\udf10 Javascript",ts:"\ud83c\udf10 Typescript"};function y(e){var t=e.children;return Array.isArray(t)||(t=[t]),(0,u.jsx)(r.Z,{className:"language-tabs",groupId:"code-tabs",children:t.map((function(e,t){return(0,u.jsx)(o.Z,{value:e.props.value,label:p[e.props.value],children:e})}))})}function m(e){var t=e.children,n=e.language,a=e.showSingleFName;return Array.isArray(t)||(t=[t]),t=t.map((function(e){return function(e,t){var n=e.props,a=(n.children,n.url),r=n.start,o=n.end,i=n.fname;if(e.type===g)return g({url:a,start:r,end:o,language:t,fname:i});return e}(e,n)})),1!=t.length||a?(0,u.jsx)(r.Z,{className:"file-tabs",children:t.map((function(e,t){return(0,u.jsx)(o.Z,{value:t,label:e.props.fname,children:e})}))}):(0,u.jsx)(o.Z,{value:0,label:t[0].props.fname,children:t[0]})}function g(e){var t=e.url,n=e.start,a=e.end,r=e.language,o=e.fname,i=e.metastring;return d({url:t,start:n,end:a,language:r,fname:o,metastring:i})}}}]);